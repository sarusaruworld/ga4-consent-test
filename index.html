<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>同意モードテスト（複数種別+カスタム）</title>

  <!-- ▼ ブリッジ用のスクリプトを先に定義 ▼ -->
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
  </script>

  <!-- ▼ Google Tag Manager (HEAD部) ▼ -->
  <script>
    (function(w,d,s,l,i){
      w[l]=w[l]||[];
      w[l].push({'gtm.start': new Date().getTime(), event:'gtm.js'});
      var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s), dl=l!='dataLayer'?'&l='+l:'';
      j.async=true;
      j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
      f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-W8J5HDXW');
  </script>
  <!-- ▲ End Google Tag Manager (HEAD部) ▲ -->

  <style>
    /* ボタンを並べやすくするための簡易CSS */
    .consent-group {
      border: 1px solid #ccc;
      margin: 1em 0;
      padding: 1em;
      display: inline-block;
    }
    .consent-group h2 {
      margin-top: 0;
    }
    button {
      margin-right: 1em;
      margin-bottom: 0.5em;
    }
  </style>
</head>
<body>
  <!-- ▼ Google Tag Manager (noscript) ▼ -->
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W8J5HDXW"
            height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript>
  <!-- ▲ End Google Tag Manager (noscript) ▲ -->

  <h1>Google 同意モード テストページ（複数種別 + カスタムキー）</h1>
  <p>各種別ごとに「同意する」「拒否する」ボタンで値を切り替えます。</p>

  <!-- Analytics Storage -->
  <div class="consent-group">
    <h2>Analytics Storage</h2>
    <button id="analyticsAccept">同意する</button>
    <button id="analyticsReject">拒否する</button>
  </div>

  <!-- Ad Storage -->
  <div class="consent-group">
    <h2>Ad Storage</h2>
    <button id="adAccept">同意する</button>
    <button id="adReject">拒否する</button>
  </div>

  <!-- Ad User Data (カスタムキー) -->
  <div class="consent-group">
    <h2>Ad User Data (Custom)</h2>
    <button id="adUserAccept">同意する</button>
    <button id="adUserReject">拒否する</button>
  </div>

  <!-- Ad Personalization (カスタムキー) -->
  <div class="consent-group">
    <h2>Ad Personalization (Custom)</h2>
    <button id="adPersAccept">同意する</button>
    <button id="adPersReject">拒否する</button>
  </div>

  <!-- Functionality Storage -->
  <div class="consent-group">
    <h2>Functionality Storage</h2>
    <button id="funcAccept">同意する</button>
    <button id="funcReject">拒否する</button>
  </div>

  <!-- Personalization Storage -->
  <div class="consent-group">
    <h2>Personalization Storage</h2>
    <button id="persAccept">同意する</button>
    <button id="persReject">拒否する</button>
  </div>

  <!-- Security Storage -->
  <div class="consent-group">
    <h2>Security Storage</h2>
    <button id="secAccept">同意する</button>
    <button id="secReject">拒否する</button>
  </div>

  <script>
    // ======================
    // Analytics Storage
    // ======================
    document.getElementById('analyticsAccept').addEventListener('click', () => {
      gtag('consent', 'update', {'analytics_storage': 'granted'});
      console.log('[Consent Mode] analytics_storage = granted');
    });
    document.getElementById('analyticsReject').addEventListener('click', () => {
      gtag('consent', 'update', {'analytics_storage': 'denied'});
      console.log('[Consent Mode] analytics_storage = denied');
    });

    // ======================
    // Ad Storage
    // ======================
    document.getElementById('adAccept').addEventListener('click', () => {
      gtag('consent', 'update', {'ad_storage': 'granted'});
      console.log('[Consent Mode] ad_storage = granted');
    });
    document.getElementById('adReject').addEventListener('click', () => {
      gtag('consent', 'update', {'ad_storage': 'denied'});
      console.log('[Consent Mode] ad_storage = denied');
    });

    // ======================
    // Ad User Data (Custom Key)
    // ===================
